# LinkedIn CSS Selectors Configuration
# Used by SelectorManager and BaseLinkedInBot
# Organized by context/page

login:
  indicators:
    - "#global-nav"
    - ".global-nav"
    - "img.global-nav__me-photo"
    - "button.global-nav__primary-link-me-menu-trigger"
    - "div.feed-identity-module"
    - "img[alt*='Photo']"
    - "#global-nav-typeahead"
    - "input.search-global-typeahead__input"

global:
  generic_buttons:
    - "button.artdeco-button--primary"
    - "button.artdeco-button--secondary"

birthday:
  card:
    - "div[role='listitem']"

messaging:
  # Buttons to open the message modal/page from a profile or list
  # Heuristic definition for robust detection
  open_button_heuristic:
    candidates: "button, a[role='button'], a.message-anywhere-button, a[href*='/messaging/compose']"
    positive_keywords:
      - "Message"
      - "Envoyer"
      - "Send"
      - "Souhaiter"
      - "Happy"
      - "Say"
    negative_keywords:
      - "Premium"
      - "Ad"
      - "Promoted"
      - "Connect"
      - "Se connecter"
      - "Follow"
      - "Suivre"
    required_attributes: {}
    weights:
      text: 40
      visible: 30
      aria: 30
    threshold: 65

  # AJOUT : Détection des boutons "Se connecter" pour échec rapide
  connect_button_heuristic:
    candidates: "button, span.artdeco-button__text"
    positive_keywords:
      - "Se connecter"
      - "Connect"
      - "Suivre"
      - "Follow"
    weights: {text: 100, visible: 50}
    threshold: 80

  # Button to identify if we are not connected (Connect/Follow)
  connect_button:
    - "button[aria-label*='Connect']"
    - "button[aria-label*='Se connecter']"
    - "button[aria-label*='Follow']"
    - "button[aria-label*='Suivre']"
    - "button:has-text('Se connecter')"
    - "button:has-text('Connect')"
    - "button:has-text('Suivre')"
    - "button:has-text('Follow')"

  # Fallback selectors (historical)
  open_button:
    - '[data-control-name="message"]'
    - '[data-control-name="compose_message"]'
    - 'button[aria-label*="Message"]'
    - 'button[aria-label*="Envoyer"]'
    - 'button[aria-label*="Souhaiter"]'
    - 'button[aria-label*="Happy"]'
    - 'a[href*="/messaging/compose"]'
    - 'button:has-text("Message")'
    - 'button:has-text("Envoyer un message")'
    - 'button:has-text("Send message")'
    - 'button:has-text("Souhaiter")'
    - 'button:has-text("Je vous souhaite")'
    - '.artdeco-button--secondary'

  # The text area inside the message modal
  # UPDATED 2025: Uses robust role and contenteditable attributes
  modal_textarea:
    - "div[role='textbox'][contenteditable='true']"
    - ".msg-form__contenteditable"
    - "div.msg-form__contenteditable[role='textbox']"

  # The send button inside the message modal
  send_button_heuristic:
    candidates: "button[type='submit'], button.msg-form__send-button, button.artdeco-button--primary"
    positive_keywords: ["Envoyer", "Send"]
    weights: {text: 50, visible: 50}
    threshold: 70

  send_button:
    - "button.msg-form__send-button"
    - "button[type='submit']"
    - 'button:has-text("Envoyer")'
    - 'button:has-text("Send")'

  # Button to close the chat overlay
  close_overlay:
    - "button[data-control-name='overlay.close_conversation_window']"
    - "button[aria-label='Close']"
    - "button[aria-label='Fermer']"

visitor:
  search:
    result_container: 'div[data-view-name="people-search-result"]'
    links:
      - 'a[data-view-name="search-result-lockup-title"]'
      - 'a.app-aware-link[href*="/in/"]'
      - 'span.entity-result__title-text a'
  profile:
    name:
      - "h1.text-heading-xlarge"
      - "h1.inline"
      - "div.ph5 h1"
      - "h1[class*='heading']"
    headline: "div.text-body-medium"
    sections:
      about: 'section:has-text("Infos"), section:has-text("About"), section:has-text("Résumé")'
      skills: 'section:has-text("Compétences"), section:has-text("Skills")'
      certifications: 'section:has-text("Licences et certifications"), section:has-text("Licenses & certifications")'
      experience: 'section:has-text("Expérience"), section:has-text("Experience")'

invitation_manager:
  list_item:
    - "li.invitation-card"
    - "div.invitation-card"
    - "li.artdeco-list__item"  # Generic fallback

  time_element:
    - "time"
    - "span.time-badge"
    - ".invitation-card__action-container span.t-black--light" # Heuristic: text often next to buttons

  withdraw_button:
    - "button[aria-label*='Retirer']"
    - "button[aria-label*='Withdraw']"
    - "button:has-text('Retirer')"
    - "button:has-text('Withdraw')"

  modal:
    container: "div[role='dialog']"
    confirm_button:
      - "div[role='dialog'] button.artdeco-button--primary"
      - "div[role='dialog'] button:has-text('Retirer')"
      - "div[role='dialog'] button:has-text('Withdraw')"
